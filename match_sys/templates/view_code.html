{% extends 'layout0.html' %}
{% load staticfiles %}

{% block title %}查看代码: {{code.title}}{% endblock %}

{% block header %}
<div class='col-sm-6'>
    <h1>代码: {{code.name}}</h1>
</div>
<div class='col-sm-6 text-right'>
    <h1><a href="/user/code.author.id/">作者: {{code.author.username}}</a></h1>
</div>
{% endblock %}

{% block body %}
<div class='row x_block'>
    <div class='col-sm-4'>
        <p>名称: {{code.name}}</p>
        <p>类型: {{code.get_ai_type_display}}</p>
        <p>等级分: {{code.score_show}}</p>
    </div>
    <div class='col-sm-4'>
        <p>参与的比赛数: {{code.num_matches}}</p>
        <p>参与的对战数: {{code.num_records}}</p>
        <p>战绩: {{code.num_wins}}胜; {{code.num_loses}}负; {{code.num_draws}}平</p>
    </div>
    <div class='col-sm-4'>
        <p>对战：
            {%if my_code%}
            <a href="/lobby/run_match/{{code.ai_type}}/?code1={{code.id}}">发起对战</a>
            {%endif%}
            <a href="/lobby/run_match/{{code.ai_type}}/?code2={{code.id}}">挑战该代码</a>
        </p>
        <p>操作：
            {%if my_code%}
            <a href="">删除代码</a>
            {%endif%}
        </p>
    </div>
</div>
<div class='row'>
    <!-- 作为发起者 -->
    <div class='col-sm-6'>
        <div class="x_title">
            <h1>发起的比赛：</h1>
        </div>
        {% with match_list=match_pool1 %}
        {% include "sub/code_match_table.html" %}
        {% endwith %}
    </div>
    <!-- 作为接受者 -->
    <div class='col-sm-6'>
        <div class="x_title">
            <h1>收到的比赛：</h1>
        </div>
        {% with match_list=match_pool2 %}
        {% with receive=1 %}
        {% include "sub/code_match_table.html" %}
        {% endwith %}
        {% endwith %}
    </div>
</div>
{% endblock %}

{% block script %}
<script>
    window.addEventListener('load', () => {
        setTimeout(() => {
            window.location.href += ''
        }, 10000)
    })
</script>
{% endblock %}